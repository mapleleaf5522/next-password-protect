import{__awaiter as e,__generator as o}from"../../node_modules/tslib/tslib.es6.js";import r from"../../node_modules/cookie/index.js";import n from"../../node_modules/jsonwebtoken/index.js";import{sendJson as t}from"./sendJson.js";var i=function(i,s){return function(d,a){return e(void 0,void 0,void 0,(function(){var e,u,c;return o(this,(function(o){a.setHeader("Content-Type","application/json"),a.setHeader("Cache-Control","no-cache, no-store, must-revalidate"),a.setHeader("Pragma","no-cache"),a.setHeader("Expires","0");try{if("GET"!==d.method)throw new Error("Invalid method.");if(null===(c=null==d?void 0:d.headers)||void 0===c?void 0:c.cookie)return e=r.parse(d.headers.cookie),u=(null==s?void 0:s.cookieName)||"next-password-protect",n.verify(null==e?void 0:e[u],i),t(a,200),[2];t(a,401)}catch(e){if("JsonWebTokenError"===e.name)return t(a,401),[2];t(a,500,{message:(null==e?void 0:e.message)||"An error has occured."})}return[2]}))}))}};export{i as passwordCheckHandler};
//# sourceMappingURL=passwordCheckHandler.js.map
