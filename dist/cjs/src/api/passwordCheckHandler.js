"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../node_modules/tslib/tslib.es6.js"),o=require("../../node_modules/cookie/index.js"),r=require("../../node_modules/jsonwebtoken/index.js"),n=require("./sendJson.js");exports.passwordCheckHandler=function(s,t){return function(d,i){return e.__awaiter(void 0,void 0,void 0,(function(){var a,u,l;return e.__generator(this,(function(e){i.setHeader("Content-Type","application/json"),i.setHeader("Cache-Control","no-cache, no-store, must-revalidate"),i.setHeader("Pragma","no-cache"),i.setHeader("Expires","0");try{if("GET"!==d.method)throw new Error("Invalid method.");if(null===(l=null==d?void 0:d.headers)||void 0===l?void 0:l.cookie)return a=o.default.parse(d.headers.cookie),u=(null==t?void 0:t.cookieName)||"next-password-protect",r.default.verify(null==a?void 0:a[u],s),n.sendJson(i,200),[2];n.sendJson(i,401)}catch(e){if("JsonWebTokenError"===e.name)return n.sendJson(i,401),[2];n.sendJson(i,500,{message:(null==e?void 0:e.message)||"An error has occured."})}return[2]}))}))}};
//# sourceMappingURL=passwordCheckHandler.js.map
